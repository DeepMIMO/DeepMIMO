ðŸ§ª Look_at Function Verification Tests
Testing all modifications and improvements...
============================================================
TEST 1: Basic Functionality
============================================================

ðŸ”§ Testing bs_look_at...
BS position: [ 0  0 10]
Target UE position: [100.    0.    1.5]
Result BS rotation: [ 0.         -4.85846292  0.        ]
Expected: azimuthâ‰ˆ0Â°, elevationâ‰ˆ-5Â° (pointing down), z_rot=0
âœ… Azimuth: 0.00Â° (expected: 0.00Â°)
âœ… Elevation: -4.86Â° (expected: -4.86Â°)
âœ… Z_rot preserved: 0.00Â°

ðŸ”§ Testing ue_look_at...
UE positions: 
[[ 100.     0.     1.5]
 [   0.   100.     1.5]
 [-100.     0.     1.5]
 [   0.  -100.     1.5]
 [ 100.   100.     1.5]]
BS position: [ 0  0 10]
Result UE rotations: 
[[ 180.            4.85846292    0.        ]
 [ -90.            4.85846292    0.        ]
 [   0.            4.85846292    0.        ]
 [  90.            4.85846292    0.        ]
 [-135.            3.43957207    0.        ]]
  UE1: azimuth=180.0Â° (exp: 180.0Â°), elevation=4.9Â° (exp: 4.9Â°)
  UE2: azimuth=-90.0Â° (exp: -90.0Â°), elevation=4.9Â° (exp: 4.9Â°)
  UE3: azimuth=0.0Â° (exp: 0.0Â°), elevation=4.9Â° (exp: 4.9Â°)
  UE4: azimuth=90.0Â° (exp: 90.0Â°), elevation=4.9Â° (exp: 4.9Â°)
  UE5: azimuth=-135.0Â° (exp: -135.0Â°), elevation=3.4Â° (exp: 3.4Â°)

============================================================
TEST 2: Coordinate Handling (2D/3D)
============================================================

ðŸ”§ Testing 2D coordinates...
2D target: [100, 50]
Result: [26.56505118 -5.1110897   0.        ]
âœ… 2D handling: azimuth=26.57Â° (expected: 26.57Â°)
âœ… 2D handling: elevation=-5.11Â° (expected: -5.11Â°)

============================================================
TEST 3: Z_rot Preservation
============================================================
Initial BS z_rot: 45.0Â°
Initial UE z_rots: [10 20 30 40 50]
Final BS z_rot: 45.0Â°
Final UE z_rots: [10. 20. 30. 40. 50.]
âœ… BS z_rot preserved: True
âœ… UE z_rots preserved: True

============================================================
TEST 4: Edge Cases
============================================================

ðŸ”§ Testing different ue_look_at input formats...
1. Single position (list): [50, 50, 5]
   âœ… Success: (5, 3) rotations generated
2. Individual positions (5 UEs):
   âœ… Success: (5, 3) rotations generated
   Different azimuths: True
3. Wrong number of positions (3 targets for 5 UEs):
   âœ… Correctly caught error: Number of target positions (3) must match number of users (5)

============================================================
TEST 6: Performance Test
============================================================
Testing with 1000 UEs...
âœ… Vectorized processing time: 0.09 ms
âœ… Result shape: (1000, 3)

============================================================
TEST 5: Compute Channels Integration
============================================================
Testing compute_channels after bs_look_at...
BS rotation after look_at: [45.         -4.04469124  0.        ]
Testing compute_channels after ue_look_at...
UE rotations after look_at: [[ 180.            4.85846292    0.        ]
 [ -90.            4.85846292    0.        ]
 [   0.            4.85846292    0.        ]
 [  90.            4.85846292    0.        ]
 [-135.            3.43957207    0.        ]]
âœ… Integration test passed - rotation parameters are properly set for compute_channels

============================================================
ðŸŽ‰ ALL TESTS COMPLETED!
============================================================
âœ… Basic functionality works
âœ… 2D/3D coordinate handling works
âœ… Z_rot preservation works
âœ… Edge cases handled properly
âœ… Compute channels integration verified
âœ… Performance improvements verified

âœ¨ All modifications are working correctly! âœ¨
